<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regimed | Usuario</title>
    <link rel="icon" href="/images/logo/LogoPositive.png" type="image/png">
    <link rel="stylesheet" href="/styles/visor/visor.css">
    <script src="https://kit.fontawesome.com/f5b8feb020.js" crossorigin="anonymous"></script>
    <script defer src="/scripts/common/verConsulta.js"></script>
    <script defer src="/scripts/common/verEstudio.js"></script>
    <script defer src="/scripts/common/aside.js"></script>
    <script defer src="/scripts/common/buscadorVacunas.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
        integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script defer src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>

<body>
    <div class="contenido">
        <aside>
            <ul>
                <a href="/">
                    <img class="logo" src="/images/logo/LogoCompPositive.png" href="">
                </a>
                <li>
                    <a href="#informacion" class="seleccionado">
                        <i class="fa-solid fa-user"></i>
                        Información
                    </a>
                </li>
                <li>
                    <a href="#vacunas">
                        <i class="fa-solid fa-syringe"></i>
                        Vacunas
                    </a>
                </li>
                <li>
                    <a href="#consultas">
                        <i class="fa-solid fa-notes-medical"></i>
                        Consultas
                    </a>
                </li>
                <!-- <li>
                    <a href="#historial">
                        <i class="fa-solid fa-file-medical"></i>
                        Historial médico
                    </a>
                </li> -->
            </ul>
        </aside>
        <main id="informacion">
            <div class="seccion">
                <div class="seccion__titulo">
                    <h1 class="seccion__titulo--titulo">
                        <i class="fa-solid fa-user"></i> Información General
                    </h1>
                </div>
                <div class="seccion__contenido informacion__general">
                    <div class="informacion__general--informacion informacion__primero">
                        <img src="/images/users/<%= imagenAMostrar %>" alt="" id="imagenGuardada">
                        <% if (typeof nombre_comp !=='undefined' && nombre_comp !==null && nombre_comp !=='' ) { %>
                            <p>
                                <%= nombre_comp %>
                            </p>
                            <% } else { %>
                                <p class="vacio">Vacío</p>
                                <% } %>
                                    <ul>
                                        <li>
                                            <span>CURP</span>
                                            <% if (typeof curp !=='undefined' && curp !==null && curp !=='' ) { %>
                                                <p>
                                                    <%= curp %>
                                                </p>
                                                <% } else { %>
                                                    <p class="vacio">Vacío</p>
                                                    <% } %>
                                        </li>
                                        <li>
                                            <span>Teléfono</span>
                                            <% if (typeof telefono !=='undefined' && telefono !==null && telefono !==''
                                                ) { %>
                                                <p>
                                                    <%= telefono %>
                                                </p>
                                                <% } else { %>
                                                    <p class="vacio">Vacío</p>
                                                    <% } %>
                                        </li>
                                    </ul>
                    </div>
                    <ul class="informacion__general--informacion informacion__lateral">
                        <li>
                            <span>Peso</span>
                            <% if (typeof peso !=='undefined' && peso !==null && peso !=='' && peso !==0) { %>
                                <p>
                                    <%= peso %> Kg
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>IMC</span>
                            <% if (typeof peso !=='undefined' && typeof estatura !=='undefined' && peso !==null &&
                                estatura !==null && peso !=='' && estatura !=='' && peso !==0 && estatura !==0) { %>
                                <% var imc=peso / (estatura * estatura); %>
                                    <p>
                                        <%= imc.toFixed(2) %>
                                    </p>
                                    <% } else { %>
                                        <p class="vacio">Vacío</p>
                                        <% } %>
                        </li>
                        <li>
                            <span>Sexo</span>
                            <% if (typeof sexo !=='undefined' && sexo !==null && sexo !=='' ) { %>
                                <p>
                                    <%= sexo %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Nacimiento</span>
                            <% if (typeof nacimiento !=='undefined' && nacimiento !==null && nacimiento !=='' &&
                                nacimiento !=='0000-00-00' ) { %>
                                <p>
                                    <%= nacimiento %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                    </ul>
                    <ul class="informacion__general--informacion informacion__lateral">
                        <li>
                            <span>Estatura</span>
                            <% if (typeof estatura !=='undefined' && estatura !==null && estatura !=='' && estatura
                                !==0) { %>
                                <p>
                                    <%= estatura %> m
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Tipo de sangre</span>
                            <% if (typeof sangre !=='undefined' && sangre !==null && sangre !=='' ) { %>
                                <p>
                                    <%= sangre %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Nacionalidad</span>
                            <% if (typeof nacionalidad !=='undefined' && nacionalidad !==null && nacionalidad !=='' ) {
                                %>
                                <p>
                                    <%= nacionalidad %>
                                </p>
                                <% } else { %>
                                    <p class="vacio">Vacío</p>
                                    <% } %>
                        </li>
                        <li>
                            <span>Edad</span>
                            <% if (typeof nacimiento !=='undefined' && nacimiento !==null && nacimiento !=='' &&
                                nacimiento !=='0000-00-00' ) { %>
                                <% var fechaNacimiento=new Date(nacimiento); var fechaActual=new Date(); var
                                    edad=fechaActual.getFullYear() - fechaNacimiento.getFullYear(); if
                                    (fechaActual.getMonth() < fechaNacimiento.getMonth() ||
                                    (fechaActual.getMonth()===fechaNacimiento.getMonth() && fechaActual.getDate() <
                                    fechaNacimiento.getDate())) { edad--; } %>
                                    <p>
                                        <%= edad %> años
                                    </p>
                                    <% } else { %>
                                        <p class="vacio">Vacío</p>
                                        <% } %>
                        </li>
                    </ul>
                </div>
            </div>
            <div id="vacunas" class="seccion">
                <div class="seccion__titulo">
                    <h1 class="seccion__titulo--titulo">
                        <i class="fa-solid fa-syringe"></i> Vacunas
                    </h1>
                </div>
                <div class="seccion__vacunas">
                    <div class="seccion__contenido">
                        <div class="buscador">
                            <input class="input" type="text" id="buscar" placeholder="Buscar vacuna...">
                            
                            <select class="input" id="ordenarPor">
                                <option value="nombre" selected>Nombre</option>
                                <option value="fecha">Fecha</option>
                                <option value="profesional">Profesional</option>
                            </select>
                        </div>
                        <div class="seccion__contenido--vacunas vacunas">
                            <% vacunas.forEach(vacunas=> { %>
                                <div class="vacuna">
                                    <div class="vacuna--informacion">
                                        <p class="vacuna__nombre"><%= vacunas.vacuna_aplicada %></p>
                                        <p>Fabricante: <%= vacunas.fabricante %></p>
                                        <p>Aplicación: <%= vacunas.fechaAplicacion %></p>
                                        <p>Dosis: <%= vacunas.dosisAdministrada %></p>
                                        <p>No. Lote: <%= vacunas.numeroLote %></p>
                                        <p>No. Serie: <%= vacunas.numeroSerie %></p>
                                        <p>Lugar de administración: <%= vacunas.lugarAdministracion %></p>
                                        <p>Profesional: <%= vacunas.nombre %></p>
                                        <p>Cédula del profesional: <%= vacunas.cedula %></p>
                                        <p>Siguiente dosis: <%= vacunas.siguienteDosis %></p>
                                    </div>
                                </div>
                            <%})%>
                        </div>
                    </div>
                </div>
            </div>
            <div id="consultas" class="seccion">
                <div id="consultas" class="seccion__titulo">
                    <h1 class="seccion__titulo--titulo">
                        <i class="fa-solid fa-notes-medical"></i> Consultas
                    </h1>
                </div>
                <div class="seccion__consultas">
                    <div class="seccion__contenido seccion__consultas--contenedor">
                        <div class="modal__subtitulo">
                            <h2>Consultas</h2>
                        </div>
                        <div class="seccion__contenido--consultas">
                            <% consultas.forEach(consultas=> { %>
                                <div class="consulta">
                                    <div class="consulta--informacion">
                                        <p>
                                            <%= consultas.observaciones %>
                                        </p>
                                        <p>Profesional: <%= consultas.nombre %>
                                        </p>
                                        <p>Cédula del profesional: <%= consultas.cedula %>
                                        </p>
                                        <p>Fecha: <%= consultas.fechaConsulta %>
                                        </p>
                                    </div>
                                    <div class="consulta__boton">
                                        <button class="boton-datos abrir__consulta"
                                            data-consulta-id="<%= consultas.consulta_id %>">
                                            Ver Consulta
                                        </button>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                    </div>
                    <div class="seccion__contenido seccion__consultas--contenedor">
                        <div class="modal__subtitulo">
                            <h2>Estudios</h2>
                        </div>
                        <div class="seccion__contenido--consultas">
                            <% estudios.forEach(estudios=> { %>
                                <div class="consulta">
                                    <div class="consulta--informacion">
                                        <p class="vacuna__nombre">
                                            <%= estudios.tipoEstudio %>
                                        </p>
                                        <p>Motivo: <%= estudios.motivoEstudio %>
                                        </p>
                                        <p>Profesional: <%= estudios.nombre %>
                                        </p>
                                        <p>Cédula del profesional: <%= estudios.cedula %>
                                        </p>
                                        <p>Fecha: <%= estudios.fechaEstudio %>
                                        </p>
                                    </div>
                                    <div class="estudio__boton">
                                        <button class="boton-datos abrir__estudio"
                                            data-estudio-id="<%= estudios.estudio_id %>">
                                            Ver Estudio
                                        </button>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="fondo__consulta" class="fondo__modal">
        <div id="ventana__consulta" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-square-virus"></i>Consulta
            </h1>
            <div class="modal__contenido consulta__contenido">
                <div class="consulta__datos" id="consulta__datos">
                    <!-- Aquí se mostrarán las observaciones, pronóstico y plan terapéutico -->
                </div>
                <div id="consulta__medicamentos" class="consulta__dato">
                    <h2>Medicamentos</h2>
                    <div class="consulta__medicamentos">
                        <table>
                            <!-- Aquí se mostrarán los medicamentos -->
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal__botones">
                <button id="cerrar__consulta" class="boton-datos">Cerrar</button>
            </div>
        </div>
    </div>

    <div id="fondo__agregarEstudio" class="fondo__modal">
        <form id="modal__agregarEstudio" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-notes-medical"></i> Agregar Estudio
            </h1>
            <div class="modal__contenido modal__contenido--agregarEstudio">
                <div class="consultas__textArea">
                    <label class="label">Tipo de estudio <span class="asterisk">*</span></label>
                    <input name="tipoEstudio" class="input" type="text">
                    <label class="label">Motivo del estudio <span class="asterisk">*</span></label>
                    <textarea name="motivoEstudio" class="input"></textarea>
                    <label class="label">Descripción <span class="asterisk">*</span></label>
                    <textarea name="descripcion" class="input"></textarea>
                    <label class="label">Resultados</label>
                    <textarea name="resultados" class="input"></textarea>
                    <!-- <label class="label">Archivos adjuntos</label>
			        <input class="inputFile" name="archivosAdjuntos" id="archivosAdjuntos" type="file"> -->
                    <label class="label">Fecha del estudio</label>
                    <input name="fechaEstudio" type="date" class="input" id="fechaEstudio">

                </div>
            </div>
            <div class="modal__botones">
                <button type="submit" class="boton-datos" id="agregarEstudio">
                    <i class="fa-solid fa-plus"></i> Agregar
                </button>
                <button type="button" class="boton-datos boton-cancelar" id="cerrar__agregarEstudio">
                    <i class="fa-solid fa-x"></i> Cancelar
                </button>
            </div>
        </form>
    </div>

    <div id="fondo__estudio" class="fondo__modal">
        <div id="ventana__estudio" class="modal">
            <h1 class="modal__titulo">
                <i class="fa-solid fa-square-virus"></i> Estudio
            </h1>
            <div class="modal__contenido estudio__contenido">
                <div class="estudio__datos" id="estudio__datos">
                    <!-- Aquí se mostrarán los detalles del estudio -->
                </div>
            </div>
            <div class="modal__botones">
                <button id="cerrar__estudio" class="boton-datos">Cerrar</button>
            </div>
        </div>
    </div>

    <%- include('../includes/loader') %>
</body>

</html>